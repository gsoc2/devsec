name: decoder/windows-event/0

metadata:
  module: Windows
  title: Base decoder for Windows events.
  description: This Windows decoder normalizes common fields from Windows events.
  versions: [Vista, "7", "8", "10", "11", Server 2012, Server 2016, Server 2019, Server 2022]
  compatibility: This decoder has been tested on Wazuh version 4.3.
  author:
    name: Wazuh, Inc.
    date: 2023/01/23
  references:
    - https://learn.microsoft.com/en-us/windows/win32/events/windows-events

check:
  - event.module: windows

normalize:
  - map:
      - windows: parse_xml($event.original, windows)

      - event.dataset: general
      - event.start: $windows.System.TimeCreated.@SystemTime
      - event.code: $windows.System.EventID.#text
      - event.id: $windows.System.EventID.#text
      - event.kind: event
      - event.provider: $windows.System.Provider.@Name

      - host.name: $windows.System.Computer.#text

      - _win_log_level:
          "0": "Audit"
          "1": "Critical"
          "2": "Error"
          "3": "Warning"
          "4": "Information"
          "5": "Verbose"
      - log.level: get_value($_win_log_level, $windows.System.Level.#text)

      - wazuh.decoders: array_append(windows-event)
